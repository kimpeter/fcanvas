<!DOCTYPE html>
<html xmlns:fb="http://ogp.me/ns/fb#" xmlns:og="http://ogp.me/ns#">
<head prefix="og: http://ogp.me/ns#">
  <title>Hospital</title>

  <%= stylesheet_link_tag "application", media: "all", "data-turbolinks-track" => true %>
  <%= javascript_include_tag "application", "data-turbolinks-track" => true %>
  <%= csrf_meta_tags %>
  <meta property="fb:app_id" content="<%= FACEBOOK_CONFIG[:app_id] %>" />
  <meta property="og:type"   content="myapp:myobject" />
  <meta property="og:url"  content="https://www.disney.com" />
  <meta property="og:title"  content="기적의 어린이재활병원" />
  <meta property="og:image"  content="http://farm4.staticflickr.com/3665/10288523825_3fea0316ef_o.jpg" />

</head>
<body id="main">
  <div id="fb-root"></div>
  <script type="text/javascript">
  ;(function($) {
      $(function() {
          $('#comment_open').bind('click', function(e) {
              e.preventDefault();
              $('#comment_popup').bPopup({
                follow: [false, false], //x, y
                position: [101, 850] //x, y
              });
          });

          $(document).ready(function(){
              $("#comments_box").infinitescroll({
                navSelector: "nav.pagination",
                nextSelector: "nav.pagination a[rel=next]",
                itemSelector: "#wall_posts"
              });
            <% if flash[:popup] == "complete" %>
              $('#comment_complete_popup').bPopup({
                follow: [false, false], //x, y
                position: [200, 850] //x, y
              });
            <% elsif flash[:popup] == "invalid" %>
              $('#comment_invalid_popup').bPopup({
                follow: [false, false], //x, y
                position: [200, 850] //x, y
              });
            <% end %>
          });

      });
  })(jQuery);

window.fbAsyncInit = function() {
// init the FB JS SDK
  FB.init({
    appId      : '<%= FACEBOOK_CONFIG[:app_id] %>',                        // App ID from the app dashboard
    channelUrl : '//<%= FACEBOOK_CONFIG[:domain] %>/channel.html', // Channel file for x-domain comms
    status     : true, // check login status
    cookie     : true, // enable cookies to allow the server to access the session
    xfbml      : true  // parse XFBML
  });

  FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {

      var uid = response.authResponse.userID;
      var accessToken = response.authResponse.accessToken;
      $("#uid").val(uid);
      $("#access_token").val(accessToken);
      $.post( "/users", {uid: uid, access_token: accessToken}, function( data ) {

      });
    } else if (response.status === 'not_authorized') {
      FB.login(function(response){

        var uid = response.authResponse.userID;
        var accessToken = response.authResponse.accessToken;
        $("#uid").val(uid);
        $("#access_token").val(accessToken);
        $.post( "/users", {uid: uid, access_token: accessToken}, function( data ) {

      });   ,{scope: 'email, publish_stream, user_relationship_details,user_photos,publish_actions'});
    } else {
  
    }
  });
  FB.api(
    'me/hero_for_children:become',
    'post',
    {
      hero: "http://samples.ogp.me/179815208874293"
    },
    function(response) {
      // handle the response
    }
  );
  FB.Canvas.setSize();
  FB.Canvas.setAutoGrow();
  FB.Event.subscribe('edge.create',
        function(href, widget) {
          location.reload();
          location.href()
        }
    );
};

(function(d){
  var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement('script'); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js";
  ref.parentNode.insertBefore(js, ref);
}(document));

</script>
<%= yield %>


</body>
</html>
